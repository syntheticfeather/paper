好的，我们继续学习概率论的第三章。根据您提供的课件内容，第三章的主题是**多维随机变量及其分布**。

---

## **第三章 多维随机变量及其分布**

### **章节一：二维随机变量及其联合分布**

#### **1. 二维随机变量 (Two-dimensional Random Variable)**
*   **定义**：设X和Y是定义在同一个样本空间Ω上的两个随机变量，则称(X, Y)为一个**二维随机变量**（或二维随机向量）。
*   **核心思想**：在实际问题中，一个试验的结果往往需要用两个或多个随机变量来描述。例如，研究一个家庭，需要同时考虑“孩子数量”和“年收入”；研究一个电子元件，需要同时考虑“寿命”和“功耗”。
*   **表示**：用有序对(X, Y)表示，其取值为(x, y)。

#### **2. 联合分布函数 (Joint Distribution Function)**
*   **定义**：对于任意实数x, y，函数
    $F(x, y) = P(X \leq x, Y \leq y)$
    称为二维随机变量(X, Y)的**联合分布函数**。
*   **几何意义**：F(x, y)表示随机点(X, Y)落在以(x, y)为右上角顶点的无穷矩形区域 $(-\infty, x] \times (-\infty, y]$ 内的概率。
*   **性质**：
    1.  **有界性**：$0 \leq F(x, y) \leq 1$，且 $\lim_{x,y \to -\infty} F(x,y) = 0$，$\lim_{x,y \to +\infty} F(x,y) = 1$。
    2.  **单调性**：F(x, y)关于x和y都是单调不减的。
    3.  **右连续性**：F(x, y)关于x和y都是右连续的。
    4.  **非负性（矩形不等式）**：对于任意 $x_1 < x_2, y_1 < y_2$，有
        $P(x_1 < X \leq x_2, y_1 < Y \leq y_2) = F(x_2, y_2) - F(x_2, y_1) - F(x_1, y_2) + F(x_1, y_1) \geq 0$

#### **3. 边缘分布 (Marginal Distribution)**
*   **定义**：由联合分布函数F(x, y)可以得到单个随机变量的分布函数。
    *   X的**边缘分布函数**：$F_X(x) = P(X \leq x) = P(X \leq x, Y < +\infty) = F(x, +\infty)$
    *   Y的**边缘分布函数**：$F_Y(y) = P(Y \leq y) = P(X < +\infty, Y \leq y) = F(+\infty, y)$
*   **意义**：边缘分布描述了单个随机变量的统计规律，它“丢失”了两个变量之间的关联信息。

---

### **章节二：离散型与连续型二维随机变量**

#### **1. 离散型二维随机变量**
*   **定义**：如果二维随机变量(X, Y)的所有可能取值是有限对或可列无限对，则称(X, Y)为离散型二维随机变量。
*   **联合分布律 (Joint PMF)**：
    $P(X = x_i, Y = y_j) = p_{ij}, \quad i,j = 1,2,...$
    称为(X, Y)的联合分布律。
*   **性质**：
    1.  $p_{ij} \geq 0$
    2.  $\sum_{i}\sum_{j} p_{ij} = 1$
*   **边缘分布律 (Marginal PMF)**：
    *   $P(X = x_i) = \sum_{j} p_{ij} = p_{i\cdot}$ （对j求和）
    *   $P(Y = y_j) = \sum_{i} p_{ij} = p_{\cdot j}$ （对i求和）

#### **2. 连续型二维随机变量**
*   **定义**：如果存在一个非负函数f(x, y)，使得对于任意实数x, y，都有
    $F(x, y) = \int_{-\infty}^{y} \int_{-\infty}^{x} f(u, v) du dv$
    则称(X, Y)为**连续型二维随机变量**，称f(x, y)为(X, Y)的**联合概率密度函数 (Joint PDF)**。
*   **联合密度函数的性质**：
    1.  **非负性**：$f(x, y) \geq 0$
    2.  **归一性**：$\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f(x, y) dx dy = 1$
    3.  **概率计算**：对于平面上的任意区域G，有
        $P((X,Y) \in G) = \iint_G f(x, y) dx dy$
*   **边缘密度函数 (Marginal PDF)**：
    *   X的边缘密度：$f_X(x) = \int_{-\infty}^{+\infty} f(x, y) dy$
    *   Y的边缘密度：$f_Y(y) = \int_{-\infty}^{+\infty} f(x, y) dx$
    *   **推导**：由 $F_X(x) = F(x, +\infty) = \int_{-\infty}^{x} \left( \int_{-\infty}^{+\infty} f(u, y) dy \right) du$，根据一元微积分基本定理，$f_X(x) = \frac{d}{dx}F_X(x) = \int_{-\infty}^{+\infty} f(x, y) dy$。

---

### **章节三：条件分布与随机变量的独立性**

#### **1. 条件分布 (Conditional Distribution)**
*   **背景**：类似于一维的条件概率，我们想知道在已知一个变量取值的条件下，另一个变量的分布。
*   **离散型**：
    *   在Y = yⱼ的条件下，X的条件分布律为：
        $P(X = x_i | Y = y_j) = \frac{P(X = x_i, Y = y_j)}{P(Y = y_j)} = \frac{p_{ij}}{p_{\cdot j}}$
        （要求 $P(Y = y_j) > 0$）
*   **连续型**：
    *   在Y = y的条件下，X的**条件密度函数**为：
        $f_{X|Y}(x|y) = \frac{f(x, y)}{f_Y(y)}$
        （要求 $f_Y(y) > 0$）
    *   类似地，$f_{Y|X}(y|x) = \frac{f(x, y)}{f_X(x)}$ （要求 $f_X(x) > 0$）

#### **2. 随机变量的独立性**
*   **定义**：如果对于所有x, y，都有
    $F(x, y) = F_X(x) F_Y(y)$
    则称随机变量X和Y是**相互独立**的。
*   **等价条件**：
    *   对于离散型：$P(X = x_i, Y = y_j) = P(X = x_i) P(Y = y_j)$ 对所有i, j成立。
    *   对于连续型：$f(x, y) = f_X(x) f_Y(x)$ 几乎处处成立。
*   **判断独立性**：最常用的方法是检查联合分布是否等于边缘分布的乘积。

---

### **章节四：二维随机变量函数的分布**

#### **1. 问题引入**
*   已知(X, Y)的联合分布，如何求Z = g(X, Y)的分布？
*   常见的函数形式：Z = X + Y, Z = XY, Z = max(X, Y), Z = min(X, Y)等。

#### **2. 主要方法**
*   **分布函数法**（最通用）：
    1.  先求Z的分布函数 $G(z) = P(Z \leq z) = P(g(X, Y) \leq z)$。
    2.  将不等式 $g(X, Y) \leq z$ 转化为平面上的一个区域。
    3.  利用(X, Y)的联合分布（分布函数或密度函数）计算该区域的概率。
    4.  对G(z)求导得到Z的密度函数g(z)。
*   **卷积公式 (Convolution Formula)**：专门用于求Z = X + Y的分布。
    *   若X, Y相互独立，其密度函数分别为f_X(x), f_Y(y)，则Z = X + Y的密度函数为：
        $f_Z(z) = \int_{-\infty}^{+\infty} f_X(x) f_Y(z - x) dx = \int_{-\infty}^{+\infty} f_X(z - y) f_Y(y) dy$
        这个积分称为f_X和f_Y的**卷积**。
*   **其他函数**：
    *   对于Z = max(X, Y)或Z = min(X, Y)，可以通过分布函数法直接求解。
    *   例如，$F_{\max}(z) = P(\max(X,Y) \leq z) = P(X \leq z, Y \leq z) = F(z, z)$

---
第三章将一维随机变量的理论推广到了二维，引入了“联合分布”、“边缘分布”、“条件分布”和“独立性”等核心概念。理解两个随机变量之间的关系是分析更复杂随机现象的基础。掌握二维随机变量函数的分布求法，特别是卷积公式，是本章的重点和难点。


好的，我们通过一系列精心设计的例题来覆盖和巩固概率论第三章**多维随机变量及其分布**的核心知识点。

---

### **例题1：二维离散型随机变量与联合分布律**

**题目**：将一枚均匀的骰子掷两次，设X为第一次的点数，Y为两次点数之和。
1.  写出(X, Y)的联合分布律。
2.  求X和Y的边缘分布律。
3.  求P(Y = 7) 和 P(X = 3, Y = 7)。

**解答**：
1.  **联合分布律**：
    *   X的可能取值：1, 2, 3, 4, 5, 6
    *   Y的可能取值：2, 3, ..., 12
    *   样本空间共有36个等可能样本点。
    *   联合概率 $P(X=i, Y=j) = P(\text{第一次为}i, \text{第二次为}j-i)$，要求 $1 \leq j-i \leq 6$。
    *   例如：
        *   $P(X=1, Y=2) = P(\text{第一次1, 第二次1}) = 1/36$
        *   $P(X=1, Y=7) = P(\text{第一次1, 第二次6}) = 1/36$
        *   $P(X=2, Y=7) = P(\text{第一次2, 第二次5}) = 1/36$
        *   $P(X=3, Y=2) = 0$（因为第二次点数不能为-1）
    *   完整的联合分布律表（部分）：

| X\Y | 2   | 3   | ... | 7   | ... | 12  |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **1** | 1/36 | 1/36 | ... | 1/36 | ... | 0   |
| **2** | 0   | 1/36 | ... | 1/36 | ... | 0   |
| **3** | 0   | 0   | ... | 1/36 | ... | 0   |
| **4** | 0   | 0   | ... | 1/36 | ... | 0   |
| **5** | 0   | 0   | ... | 1/36 | ... | 0   |
| **6** | 0   | 0   | ... | 1/36 | ... | 1/36 |

2.  **边缘分布律**：
    *   X的边缘分布：$P(X=i) = \sum_j P(X=i, Y=j)$
        *   对每个i，Y的可能取值从i+1到i+6，共6个值，每个概率1/36。
        *   所以 $P(X=i) = 6 \times (1/36) = 1/6$，i=1,2,...,6。
        *   X ~ (0-1)分布？不，X是离散均匀分布。
    *   Y的边缘分布：$P(Y=j) = \sum_i P(X=i, Y=j)$
        *   例如 $P(Y=7) = P(X=1,Y=7) + P(X=2,Y=7) + ... + P(X=6,Y=7) = 6 \times (1/36) = 1/6$
        *   $P(Y=2) = P(X=1,Y=2) = 1/36$
        *   $P(Y=3) = P(X=1,Y=3) + P(X=2,Y=3) = 2/36$，依此类推。

3.  **计算概率**：
    *   $P(Y=7) = 6/36 = 1/6$ （由边缘分布）
    *   $P(X=3, Y=7) = 1/36$ （由联合分布）

**覆盖知识点**：二维离散型随机变量、联合分布律、边缘分布律的计算、利用联合分布求概率。

---

### **例题2：二维连续型随机变量与联合密度**

**题目**：设二维随机变量(X, Y)的联合概率密度函数为
$f(x, y) = \begin{cases} C(x + y), & 0 < x < 1, 0 < y < 1 \\ 0, & \text{其它} \end{cases}$
1.  求常数C。
2.  求X和Y的边缘密度函数。
3.  求P(X > 0.5, Y < 0.5)。

**解答**：
1.  **求常数C**：
    利用联合密度的归一性：
    $\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f(x,y) dx dy = \int_{0}^{1} \int_{0}^{1} C(x + y) dx dy = 1$
    先对x积分：$\int_{0}^{1} (x + y) dx = \left[\frac{x^2}{2} + xy\right]_{0}^{1} = \frac{1}{2} + y$
    再对y积分：$\int_{0}^{1} C(\frac{1}{2} + y) dy = C \left[\frac{1}{2}y + \frac{y^2}{2}\right]_{0}^{1} = C (\frac{1}{2} + \frac{1}{2}) = C$
    所以 C = 1。

2.  **边缘密度函数**：
    *   X的边缘密度：
        $f_X(x) = \int_{-\infty}^{+\infty} f(x,y) dy = \int_{0}^{1} (x + y) dy = \left[xy + \frac{y^2}{2}\right]_{0}^{1} = x + \frac{1}{2}, \quad 0 < x < 1$
    *   Y的边缘密度：
        $f_Y(y) = \int_{-\infty}^{+\infty} f(x,y) dx = \int_{0}^{1} (x + y) dx = \left[\frac{x^2}{2} + xy\right]_{0}^{1} = \frac{1}{2} + y, \quad 0 < y < 1$
    *   注意：$f_X(x) = x + 1/2$，$f_Y(y) = y + 1/2$，形式相同。

3.  **计算概率**：
    $P(X > 0.5, Y < 0.5) = \int_{0.5}^{1} \int_{0}^{0.5} (x + y) dy dx$
    先对y积分：$\int_{0}^{0.5} (x + y) dy = \left[xy + \frac{y^2}{2}\right]_{0}^{0.5} = 0.5x + \frac{(0.5)^2}{2} = 0.5x + 0.125$
    再对x积分：$\int_{0.5}^{1} (0.5x + 0.125) dx = \left[0.25x^2 + 0.125x\right]_{0.5}^{1} = (0.25 + 0.125) - (0.25 \times 0.25 + 0.125 \times 0.5) = 0.375 - (0.0625 + 0.0625) = 0.375 - 0.125 = 0.25$

**覆盖知识点**：联合概率密度函数、归一性求常数、边缘密度函数的计算、利用联合密度计算区域概率。

---

### **例题3：条件分布**

**题目**：接例题2，求在X=0.6的条件下，Y的条件密度函数。

**解答**：
1.  **条件密度公式**：
    $f_{Y|X}(y|x) = \frac{f(x,y)}{f_X(x)}$
2.  **代入已知**：
    *   $f(x,y) = x + y$，$f_X(x) = x + 1/2$
    *   所以 $f_{Y|X}(y|0.6) = \frac{0.6 + y}{0.6 + 0.5} = \frac{0.6 + y}{1.1}, \quad 0 < y < 1$
3.  **验证**：
    $\int_{0}^{1} f_{Y|X}(y|0.6) dy = \int_{0}^{1} \frac{0.6 + y}{1.1} dy = \frac{1}{1.1} \left[0.6y + \frac{y^2}{2}\right]_{0}^{1} = \frac{1}{1.1} (0.6 + 0.5) = \frac{1.1}{1.1} = 1$，正确。

**答案**：$f_{Y|X}(y|0.6) = \frac{0.6 + y}{1.1}, \quad 0 < y < 1$

**覆盖知识点**：连续型随机变量的条件密度函数、条件密度的计算与验证。

---

### **例题4：随机变量的独立性**

**题目**：
1.  接例题2，判断X与Y是否相互独立。
2.  若(X, Y)的联合密度为 $f(x, y) = 4xy, 0<x<1, 0<y<1$，判断X与Y是否独立。

**解答**：
1.  **判断独立性**：
    *   独立的充要条件是 $f(x,y) = f_X(x) f_Y(y)$ 对所有x,y成立。
    *   由例题2：$f(x,y) = x + y$，$f_X(x) = x + 1/2$，$f_Y(y) = y + 1/2$
    *   $f_X(x) f_Y(y) = (x + 1/2)(y + 1/2) = xy + x/2 + y/2 + 1/4 \neq x + y$
    *   所以 **X与Y不独立**。
2.  **判断独立性**：
    *   $f(x,y) = 4xy, 0<x<1, 0<y<1$
    *   求边缘密度：
        *   $f_X(x) = \int_{0}^{1} 4xy dy = 4x \cdot \frac{1}{2} = 2x, \quad 0<x<1$
        *   $f_Y(y) = \int_{0}^{1} 4xy dx = 4y \cdot \frac{1}{2} = 2y, \quad 0<y<1$
    *   $f_X(x) f_Y(y) = (2x)(2y) = 4xy = f(x,y)$
    *   所以 **X与Y相互独立**。

**覆盖知识点**：随机变量独立性的定义与判定、利用联合密度与边缘密度的关系判断独立性。

---

### **例题5：二维随机变量函数的分布（卷积公式）**

**题目**：设X和Y相互独立，且都服从区间[0, 1]上的均匀分布。求Z = X + Y的概率密度函数。

**解答**：
这是一个经典问题，使用**卷积公式**。
1.  **卷积公式**：
    $f_Z(z) = \int_{-\infty}^{+\infty} f_X(x) f_Y(z - x) dx$
2.  **确定积分限**：
    *   $f_X(x) = 1, 0<x<1$
    *   $f_Y(z-x) = 1$ 当 $0 < z-x < 1$，即 $z-1 < x < z$
    *   积分需同时满足 $0 < x < 1$ 和 $z-1 < x < z$。
3.  **分情况讨论**：
    *   **当 $z \leq 0$ 或 $z \geq 2$**：无重叠，$f_Z(z) = 0$
    *   **当 $0 < z \leq 1$**：重叠区间为 $0 < x < z$，
        $f_Z(z) = \int_{0}^{z} 1 \cdot 1 dx = z$
    *   **当 $1 < z < 2$**：重叠区间为 $z-1 < x < 1$，
        $f_Z(z) = \int_{z-1}^{1} 1 \cdot 1 dx = 2 - z$
4.  **最终结果**：
    $f_Z(z) = \begin{cases} z, & 0 < z \leq 1 \\ 2 - z, & 1 < z < 2 \\ 0, & \text{其它} \end{cases}$
    这是一个三角形分布。

**覆盖知识点**：二维随机变量和的分布、卷积公式、分段积分求解。

---

### **例题6：二维随机变量函数的分布（最大值）**

**题目**：接例题5，求M = max(X, Y)的分布函数和概率密度函数。

**解答**：
使用**分布函数法**。
1.  **分布函数**：
    $F_M(m) = P(M \leq m) = P(\max(X,Y) \leq m) = P(X \leq m, Y \leq m)$
    因为X, Y独立，$= P(X \leq m) P(Y \leq m)$
    *   当 $m \leq 0$，$F_M(m) = 0$
    *   当 $0 < m < 1$，$F_M(m) = m \cdot m = m^2$
    *   当 $m \geq 1$，$F_M(m) = 1$
2.  **密度函数**：
    $f_M(m) = F_M'(m)$
    *   当 $0 < m < 1$，$f_M(m) = 2m$
    *   其它，$f_M(m) = 0$
    所以 $f_M(m) = \begin{cases} 2m, & 0 < m < 1 \\ 0, & \text{其它} \end{cases}$

**覆盖知识点**：二维随机变量函数（最大值）、分布函数法、利用独立性简化计算。

---

### **例题7：联合分布函数的性质**

**题目**：设二维随机变量(X, Y)的联合分布函数为
$F(x, y) = \begin{cases} (1 - e^{-x})(1 - e^{-y}), & x > 0, y > 0 \\ 0, & \text{其它} \end{cases}$
1.  求P(0 < X ≤ 1, 0 < Y ≤ 2)。
2.  求X的边缘分布函数。
3.  判断X与Y是否独立。

**解答**：
1.  **计算概率**：
    $P(0 < X \leq 1, 0 < Y \leq 2) = F(1,2) - F(1,0) - F(0,2) + F(0,0)$
    *   $F(1,2) = (1-e^{-1})(1-e^{-2})$
    *   $F(1,0) = 0$（因为y≤0）
    *   $F(0,2) = 0$（因为x≤0）
    *   $F(0,0) = 0$
    所以 $P = (1-e^{-1})(1-e^{-2})$
2.  **边缘分布函数**：
    $F_X(x) = F(x, +\infty) = \lim_{y \to +\infty} F(x,y)$
    *   当 $x \leq 0$，$F_X(x) = 0$
    *   当 $x > 0$，$F_X(x) = (1-e^{-x}) \cdot 1 = 1 - e^{-x}$
    所以X ~ Exp(1)
3.  **判断独立性**：
    $F(x,y) = (1-e^{-x})(1-e^{-y}) = F_X(x) F_Y(y)$，其中 $F_Y(y) = 1 - e^{-y}$（同理）。
    所以 **X与Y相互独立**。

**覆盖知识点**：联合分布函数、利用联合分布函数计算概率、边缘分布函数、独立性判定。

---
通过这七道例题，我们系统地覆盖了第三章的所有核心知识点：从离散到连续，从联合分布到边缘分布，从条件分布到独立性，再到随机变量函数的分布。这些例题展示了如何将二维随机变量的理论应用于解决实际问题。